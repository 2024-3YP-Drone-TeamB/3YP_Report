\subsection{Radar Simulations} \label{compvis_radarsims}

    \subsubsection{Introduction and Physical Principles} \label{rory_radar_principles}
    
        \noindent As described in Section \ref{simulation_justification}, the limited diversity of the radar dataset necessitates physics-driven simulations to replicate the noise and clutter encountered in real-world environments. The simulations in this section aim to test the radar model's robustness to the physical processes that degrade B-scan clarity: scattering, attenuation, antenna and transmission losses.
        
        \noindent To model these effects, finite-difference time-domain (FDTD) simulations were conducted using \textit{gprMax} \cite{warren2016gprmax}, an open-source framework for solving Maxwellâ€™s equations in 3D. These simulations capture full-wave electromagnetic behaviour, including wave propagation, reflection, and attenuation, and explicitly account for soil heterogeneity. The inclusion of surface roughness is not considered in this section, but for the purposes of validating the models robustness to noise artifacts not in the training data, just modelling the subsurface heterogeneity suffices. This is however a significant contribution to the clutter in an actual Bscan, and future work should consider this aspect.
     
    
    \subsubsection{gprMax Implementation}

        \paragraph{Radar}
        
             \noindent The radar configuration follows recommendations by Huirui (Section \ref{hardware}), and a Ricker is used as the excitation signal. A central frequency of 1.5\,GHz was used, as it provides a good compromise between penetration depth and resolution, as shown in Section \ref{hardware}. The transmitter and receiver are modelled as Herzian dipole antennas \footnote{\url{https://engineering.purdue.edu/wcchew/ece604s21/Lecture\%20Notes/Lect25.pdf}} 10cm from the surface of the soil, and separated from each other by 2cm. B-scans are produced by taking successive A-scans while moving the source and receiver in 4\,mm increments from left to right across the simulation domain
    
        \paragraph{Domain}

            \noindent The simulated computational domain spans $0.8\times 0.3\times0.02$\,m ($x\times y\times z$), representing a quasi-2D space. The domain is discretised into cubic elements of side length 0.002\,m , 100 times smaller than the wavelength of the radar pulse. Two thirds of the domain is occupied with soil, and the rest with air. A circular landmine with radius 5\,cm was buried with its centre 0.1\,m below the surface of the soil, and was modelled as a perfect electric conductor (PEC), representative of a metallic landmine. See Figure \ref{fig:radar_domain} for a visualisation fo the simulation domain.


        \paragraph{Boundary Conditions}
        
            \noindent Perfectly matched layers (PMLs) \footnote{\url{https://en.wikipedia.org/wiki/Perfectly_matched_layer}} are used as absorbing boundary conditions on all sides of the domain, to mimic an open boundary. The source and receiver were placed more than 20 cells away from the PML regions to avoid erroneous interference, as is advised in the gprMax docs. Each simulation was run for 5$\times$10$^{\text{-9}}$\,s, enough to capture all the relevant electromagnetic phenomena.

                \begin{figure}[htbp]
            \centering
            \begin{minipage}[b]{0.48\textwidth}
                \centering
                \includegraphics[width=\textwidth]{figs/Rory/radar_domain.pdf}
                \caption{(a) Simulation domain viewed in ParaView \tablefootnote{\url{https://www.paraview.org/}}}
                \label{fig:radar_domain}
            \end{minipage}
            \hfill
            \begin{minipage}[b]{0.48\textwidth}
                \centering
                \includegraphics[width=\textwidth]{figs/Rory/sim_bscan_cropped.png}
                \caption{(b) Raw simulated B-scan (no digital enhancement)}
                \label{fig:original_bscan}
            \end{minipage}
        \end{figure}
        \noindent 
    
    \subsubsection{Heterogeneous Soil Model}
    
        \noindent The heterogeneous soil is modelled using the Peplinski model, detailed in \cite{warren2016gprmax}. The model characterises soil dielectric properties based on sand fraction, clay fraction, bulk density, sand-particle density and volumetric water fraction range. To capture natural spatial variability, a fractal generation technique is employed, where self-similar patterns observed in natural soils are replicated over multiple scales (also detailed in Warren et al.).

        \paragraph{Soil Parameters}

            For the simulation to give physically realistic results, it is initialised with accurate soil data for Ukraine. Ukraine is mostly covered with the very fertile Chernozem soil \footnote{\url{https://www.britannica.com/place/Ukraine/Soils}}, the properties of which were taken from \cite{suleymanov2021chernozem}, and are summarised here.

            \begin{table}[htbp]
              \centering
              \caption{Properties of Chernozem Soils}
              \begin{tabular}{@{} l l @{}} 
                \toprule
                \textbf{Property} & \textbf{Value} \\
                \midrule
                Clay fraction & $\sim 30\%$ \\
                Sand fraction & $\sim 70\%$ \\
                Bulk density & $\sim 1.4$ g/cm$^3$ \\
                Sand particle density & $2.65$ g/cm$^3$ \\
                Volumetric water fraction range & $1\% - 10\%$ \\
                \bottomrule
              \end{tabular}
            \end{table}
    

    
    \subsubsection{Results and Validation}
    
        Figure~\ref{fig:original_bscan} shows the simulated radar responses, illustrating the backscattered signatures generated by the presence of a buried landmine. . However, computational limitations restrict the number of simulations that can be feasibly run, and the current model assumes a simplified environment with flat ground, no foliage, and an absence of puddles or other surface irregularities. These factors may contribute to discrepancies between simulated and real-world data.

    
    \subsubsection{Data Augmentation}
    
      Running these simulations is computationally intensive, so one should make the most of each simulation performed. From this one simulation, multiple image augmentations were applied, each representing a physical process. The transforms considered were stretching (representing different soil properties and mine shape), cropping (representing Bscans that did not capture the whole mine) and adding Gaussian blur (representing greater attenuation of high frequencies due to different soil properties), and combinations of these. Contrast limited adaptive histogram equalisation (CLAHE) \footnote{\url{https://en.wikipedia.org/wiki/Adaptive_histogram_equalization}} is also applied to the original image regardless of the other transformations applied, to enhance the image clarity whilst keeping the contrast manageable. When these transformations are applied to the simulated Bscan, a dataset of 90 images is generated. This is sufficient to test whether the pre-trained CNN (Section \ref{compvis_implementation}) is robust to heterogeneous soil properties and other physical loss phenomena.
        
        \begin{figure}[htbp]
          \centering
        
          \adjustbox{valign=c}{\includegraphics[width=0.32\textwidth]{figs/Rory/sim_bscan_clahe_detection_cropped.png}}
          \hfill
          \adjustbox{valign=c}{\includegraphics[width=0.32\textwidth]{figs/Rory/sim_bscan_clahe_detection_blur_cropped.png}}
          \hfill
          \adjustbox{valign=c}{\includegraphics[width=0.32\textwidth]{figs/Rory/sim_bscan_clahe_detection_blur_stretched_cropped.png}}
        
          \caption[Comparison of simulated B-scans under different pre-processing steps]{Comparison of simulated B-scans under different pre-processing steps. 
          (a) Simulated B-scan with CLAHE applied. 
          (b) Simulated B-scan with CLAHE and Gaussian blur applied. 
          (c) Simulated B-scan with CLAHE, Gaussian blur, and a vertical stretch applied. 
          In each case, the bounding boxes from the pre-trained CNN in Section \ref{compvis_implementation} are visible, with the corresponding numerical confidence level.}
          \label{fig:sim_bscan_comparison}
        \end{figure}
        
    
    \subsubsection{CV Results}
    
        The augmented radar data were subsequently analysed using the pre-trained CNN (Section \ref{compvis_implementation}) to evaluate the robustness of the model to the physical loss processes described in Section \ref{rory_radar_principles}. Precision and recall metrics were calculated on the augmented dataset, with the results summarised in Table~\ref{tab:cv_results}, indicating that the combined approach of GPSAR and SOTA CV techniques is promising for practical landmine detection. In particular it is noted that we can achieve a high precision with moderate recall with the GPSAR sensor, and that the CNN, although trained on a very homogenous 'clean' dataset generalised well to a more varied dataset from high-order simulations that directly model the noise processes (which we have argued in SEC XX is very important).

        \begin{table}[htbp]
          \centering
          \caption{Augmented Simulation Bscan Results}
          \begin{tabular}{@{} l l @{}} 
            \toprule
            \textbf{Metric} & \textbf{Value} \\
            \midrule
            Number of actual landmines & 90 \\
            Number of true positive predictions & 75 \\
            Number of false positive predictions & 7 \\
            Number of false negative predictions &  15\\
            \midrule
            \textbf{Precision} &  \textbf{91.5\%}\\
            \textbf{Recall} & \textbf{83.3\%}\\
            \bottomrule
          \end{tabular}
        \end{table}       
        
        \paragraph{Summary} These findings show that a GPSAR sensor coupled with an open-source CNN detection algorithm demonstrates great feasibility for reliably identifying buried landmines across diverse terrains. This is validated by achieving high precision (91.5\%) on a diverse dataset comprising simulated radar scans in a heterogeneous Ukrainian soil, despite being trained on a small dataset with limited variability. The system's current performance likely represents a lower bound, and it is expected that an improved system trained on a larger dataset of more varied radar scans from experimentation or simulation, would yield greater precision, potentially above 95\%. Overall, this system offers a highly maintainable and effective solution, that can improve as more context specific training data becomes available.