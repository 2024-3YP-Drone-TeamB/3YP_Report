\subsection{Cost Maps}
\subsubsection{Source data}
When considering \gls{RTS} it requires prior knowledge of the environment to be executed successfully. Therefore, this must be loaded into the drone using ground operators. The easiest and most efficient way to model this is using bird's eye images of the operating areas and marking the obstructions, suspected mined regions, mildly dangerous regions, and safe landing regions, with corresponding \gls{GNSS} co-ordinates.
\paragraph{Satellite Images}
Where satellite images are available and accurate they are the easiest and most efficient option. However, given the nature of environments effected by war, there may have been significant changes to the local environment since the last satellite image. Furthermore, seasonal changes can make satellite images less effective as trees may be less visible from winter images due to a lack of leaves.
\paragraph{Surveillance Images}
Standard consumer level drones can provide images with tagged \gls{GNSS} co ordinates that can be used, however, this requires extra hardware and time to execute. Therefore, this should be avoided where satellite images are sufficient.

\subsubsection{Graphical User Interface}
\paragraph{Platform} 
The \gls{GUI} was considered from the start to maximise usability by untrained ground operators. I built the \gls{GUI} as a simple python script that takes an image path and uses hardware-independent click locations and keystrokes to operate. It then gives he output as a .txt file with a standard format. This means that the process can be run on any local hardware available.
\paragraph{User interactions}
It is a simple program where the user can click on a region to set it a colour representing the classification. A key development was using semi-transparent colours so the base image can be seen through the shade of classification colour allows for a more natural filling experience. Furthermore, some utility functions including multi-square filling, clicking on already classified regions to deselect and auto-filling regions were added to make the process easier and faster. The process from satellite image (from Google Earth), to cost map, to a flow map is shown in \ref{fig:cost map net}. The only information uploaded to the drone is \ref{fig:cost map flow} where the arrows denote where to go next and the circles denote where, if there, the \gls{UAV} should land.

\subsubsection{Tessellated surfacing}
\paragraph{Why hexagons} While squares and triangles are more widely used, they are worse than hexagons for this application where the path planning is between central nodes and the ground operator intuitiveness must be considered. This is because, hexagons exhibit uniform adjacency meaning the distance between the central point of each hexagon and its neighbours is equal, unlike triangles and rectangles. Differences in distances are difficult to interpret as the ground operator as they change the probability of survival between nodes of the same class depending on orientation. Furthermore, travelling node to node on the diagonals of squares goes through a point of four intersection where the classification is undefined. Therefore if the user added two obstacles diagonally connected it is unknown if you could travel diagonally between them, this ambiguity creates issues that you do not face when using hexagons as while at the intersections the classifications are still undefined, when travelling centre to centre you never cross an intersection of more than two hexagons.
\paragraph{Mapping hexagons to \gls{GNSS}} \label{para:Mapping hexagons}
The two key methods of mapping from hexagons to Cartesians either uses two axial co-ordinates or using row and column values with an offset described in \cite{MappingHexagons}. Since the later is simpler to translate into matrix form it was used however, both are easy to implement. Once the converted into Cartesian form you multiply the values by the scaling factor to get offset from the origin. This is combined with the known location of the origin to generate the \gls{GNSS} tags for the centre of each hexagon.

\subsubsection{Efficient filling}
\paragraph{Auto-filling from Path Planning}
Having the ground user filling in both the path planning polygonal zones and then refilling the cost map is inefficient as there is a lot of information that is shared between the two. Therefore, provided the images used are the same, the cost map automatically classifies hexagons with an obstacle listed within its bounds as an obstacle region. It also automatically classifies the region of interest as dangerous to land as it is a mined area. This reduces the number of zones required to be filled by the end user significantly. 
\paragraph{Dynamic Zooming}
In developed or otherwise difficult operating environments higher resolutions may be needed, however, often the major zones will remain the same. Therefore, the user will have two different views, the major view that is used to fill in large zones and the minor view that the user accesses in order to fill in smaller more detailed zones. The entire map is in fact the smaller zones but this abstraction means it is easy and quick to fill in detailed maps.
\paragraph{Machine Learning Methods}
The cost map generating program not only records the final results but all of the ground operator times and clicks. This output file is  sent to the development team if the ground user has not disabled this functionality due to safety reasons. This will provide data in order to create new tools based on tasks that are taking more time to complete. It will also allow development of predictive models that can automatically fill in zones in a seamless manor using the source image and the user clicks as input data. For example, a current bottleneck is linear obstacle lines for example power, hedge or tree lines, this is tedious to fill in. However, with a machine learning approach it would mark what it suspects is the line in a lighter black after the first user click in the region and then the user can press Tab to fill in the prediction or ESC to remove the prediction. Another key improvement would be automatic region filling where, for example, the user has filled in half a field, a good prediction may be that the other half would follow the same classification and would similarly be suggested as above to the user.

\input{Thomas/Return_To_Safety/cost_map_generation}